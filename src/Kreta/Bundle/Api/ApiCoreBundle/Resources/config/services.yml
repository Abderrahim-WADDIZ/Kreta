# This file belongs to Kreta.
# The source code of application includes a LICENSE file
# with all information about license.
#
# @author benatespina <benatespina@gmail.com>
# @author gorkalaucirica <gorka.lauzirika@gmail.com>

services:
    kreta_api_core.command.create_client:
        class: Kreta\Bundle\Api\ApiCoreBundle\Command\CreateClientCommand
        calls:
            - [setContainer, ['@service_container']]

    kreta_api_core.listener.json_exception:
        class: Kreta\Bundle\Api\ApiCoreBundle\EventListener\JsonExceptionListener
        tags:
            - { name: kernel.event_listener, event: kernel.exception, method: onKernelException, priority: 200 }

    kreta_api_core.subscriber.media_url:
        class: Kreta\Bundle\Api\ApiCoreBundle\EventSubscriber\MediaUrlSubscriber
        arguments: [@router]
        tags:
            - { name: jms_serializer.event_subscriber }

    kreta_api_core.form_handler.project:
        class: Kreta\Bundle\Api\ApiCoreBundle\Form\Handler\ProjectHandler
        arguments: [@form.factory, @doctrine.orm.entity_manager, @event_dispatcher, @kreta_core.factory.media, @kreta_core.uploader.image_project]

    kreta_api_core.form_handler.issue:
        class: Kreta\Bundle\Api\ApiCoreBundle\Form\Handler\IssueHandler
        arguments: [@form.factory, @doctrine.orm.entity_manager, @event_dispatcher]

    kreta_api_core.form_handler.status:
        class: Kreta\Bundle\Api\ApiCoreBundle\Form\Handler\StatusHandler
        arguments: [@form.factory, @doctrine.orm.entity_manager, @event_dispatcher, @kreta_core.factory.media, @kreta_core.uploader.image_project]
